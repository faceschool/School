
{% extends base_template %}
{% block content %}
{% load static %}
<style>
    .table-hover tbody tr:hover {
  background-color: #f1f9ff;
}

</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

 <div class="container-fluid my-4">
  <div class="text-center mb-4">
   <h2 class="titre-principal text-primary mb-4">
  <i class="bi bi-calendar3"></i> Liste des Réunions
</h2>

  </div>

  <div class="row g-4 justify-content-center table-responsive-sm">
<input type="text" id="search" class="form-control form-control-sm mb-3" placeholder="Rechercher une réunion...">


    <!-- ================== Réunions de classe ================== -->
    <div class="col-lg-6 col-md-12 shadow-sm p-3 rounded bg-light">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="text-secondary fw-bold mb-3 border-bottom pb-2">
          <i class="bi bi-calendar3"></i> Réunions de Classe
        </h5>

        <a href="{% url 'creer_reunions' %}" class="btn btn-outline-primary btn-sm">
          <i class="bi bi-plus-circle"></i> Créer une Réunion
        </a>
      </div>

      {% for class in mesclasse %}
        <div class="mt-4">
          <h6 class="text-danger fw-bold">Classe : [ {{ class.NomClasse }} ]</h6>
          <div class="table-responsive">
            <table class="table table-striped table-bordered align-middle">
              <thead class="table-success text-center">
                <tr>
                  <th>Titre</th>
                  <th width="35%">Description</th>
                  <th>Début</th>
                  <th>Fin</th>
                  <th>État</th>
                  <th>Lien</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for reunion in reunions_list %}
                  {% if class.id == reunion.maclasse_id %}
                    <tr>
                      <td>{{ reunion.titre }}</td>
                      <td>{{ reunion.description }}</td>
                      <td>{{ reunion.date_debut|date:'d/m/Y H:i' }}</td>
                      <td>{{ reunion.date_fin|date:'d/m/Y H:i' }}</td>
                      <td class="{% if reunion.etat %}text-danger{% else %}text-primary{% endif %}">
                        {% if reunion.etat %} Terminé {% else %} Prévu {% endif %}
                      </td>
                      <td>
                        {% if not reunion.etat %}
                          <a href="{{ reunion.meet_link }}" target="_blank" class="btn btn-sm btn-outline-success">Rejoindre</a>
                        {% endif %}
                      </td>
                      <td class="text-center">
                        <a href="{% url 'modifier' reunion.id %}" class="text-success me-2"><i class="bi bi-pencil-square"></i></a>
                        <a href="{% url 'suppreunion' reunion.id %}"
                           class="text-danger"
                           onclick="return confirm('Voulez-vous vraiment supprimer cette réunion ?')">
                           <i class="bi bi-trash"></i>
                        </a>
                      </td>
                    </tr>
                  {% endif %}
                {% empty %}
                  <tr><td colspan="7" class="text-center text-danger fw-bold">Aucune réunion prévue</td></tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- ================== Réunions de groupe de travail ================== -->
    <div class="col-lg-6 col-md-12 shadow-sm p-3 rounded bg-light">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="text-secondary fw-bold mb-0"><i class="bi bi-calendar3"></i> Réunions de Groupe de Travail</h5>
        <a href="{% url 'creer_reunionGrpTrav' %}" class="btn btn-outline-primary btn-sm">
          <i class="bi bi-plus-circle"></i> Créer une Réunion
        </a>
      </div>

      {% for group in mesGroupeTrav %}
        <div class="mt-4">
          <h6 class="text-danger fw-bold">Groupe : [ {{ group.Groupe }} ]</h6>
          <div class="table-responsive">
            <table class="table table-striped table-bordered align-middle">
              <thead class="table-success text-center">
                <tr>
                  <th>Titre</th>
                  <th width="35%">Description</th>
                  <th>Début</th>
                  <th>Fin</th>
                  <th>État</th>
                  <th>Lien</th>
                  <th>Modifier</th>
                </tr>
              </thead>
              <tbody>
                {% for reunion in reunions_listGrpT %}
                  {% if group.id == reunion.groupetravail_id %}
                    <tr>
                      <td>{{ reunion.titre }}</td>
                      <td>{{ reunion.description }}</td>
                      <td>{{ reunion.date_debut|date:'d/m/Y H:i' }}</td>
                      <td>{{ reunion.date_fin|date:'d/m/Y H:i' }}</td>
                      <td class="{% if reunion.etat %}text-danger{% else %}text-primary{% endif %}">
                        {% if reunion.etat %} Terminé {% else %} Prévu {% endif %}
                      </td>
                      <td>
                        {% if not reunion.etat %}
                          <a href="{{ reunion.meet_link }}" target="_blank" class="btn btn-sm btn-outline-success">Rejoindre</a>
                        {% endif %}
                      </td>
                      <td>
                        <a href="{% url 'Modifier_reunionGrpTrav' reunion.id %}" class="text-success"><i class="bi bi-pencil-square"></i></a>
                         <a href="{% url 'suppreunionGrpTrav' reunion.id %}"
                           class="text-danger"
                           onclick="return confirm('Voulez-vous vraiment supprimer cette réunion ?')">
                           <i class="bi bi-trash"></i>
                        </a>

                      </td>
                    </tr>
                  {% endif %}
                {% empty %}
                  <tr><td colspan="7" class="text-center text-danger fw-bold">Aucune réunion de groupe prévue</td></tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      {% endfor %}
    </div>

  </div>
</div>
<script>
document.getElementById('search').addEventListener('keyup', function() {
  let search = this.value.toLowerCase();
  document.querySelectorAll('tbody tr').forEach(row => {
    row.style.display = row.textContent.toLowerCase().includes(search) ? '' : 'none';
  });
});
</script>

{% endblock %}