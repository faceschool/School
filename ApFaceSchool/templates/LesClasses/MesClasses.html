{% extends "Menus/MenuEspaceForm.html" %}
{% block content %}
{% load static %}

<div class="container-fluid mt-4">

  <!-- En-t√™te -->
  <div class="text-center mb-4">
    <img width="90" class="rounded-circle shadow-sm mb-2"
         src="https://img.freepik.com/vecteurs-premium/icone-classe-etudiants-illustration-3d-collection-retour-ecole-icone-classe-creative-etudiants-3d-pour-modeles-conception-web-infographie-plus-encore_676904-3130.jpg"
         alt="Mes classes">
    <h4 class="fw-bold text-danger">
      Mes Classes : [{{ TotalClasse }}]
    </h4>
  </div>

  <!-- Boutons d'action -->
  <div class="text-center mb-4">
    <a href="{% url 'CreerClasses' %}" class="btn btn-primary btn-md mx-2 shadow-sm action-btn">
      <i class="bi bi-plus-circle me-1"></i>Cr√©er une Classe
    </a>
    <a href="{% url 'ListepartClasses' %}" class="btn btn-info btn-md mx-2 shadow-sm text-white action-btn">
      <i class="bi bi-handshake me-1"></i>Liste des Partenariats
    </a>
  </div>

  <!-- Barre de recherche -->
  <div class="row justify-content-center mb-3">
    <div class="col-md-6 col-sm-10 text-center">
      <input type="text" id="searchInput" class="form-control shadow-sm"
             placeholder="üîç Rechercher une classe, un niveau, un chef...">
    </div>
  </div>

  <hr>

  <!-- Tableau des classes -->
  <div class="row justify-content-center mb-5">
    <div class="col-md-10 table-responsive shadow-lg p-4 bg-white rounded-4">

      {% if MesClas %}
        <table id="classesTable" class="table table-hover table-bordered align-middle text-center">
          <thead class="table-success">
            <tr>
              <th>Code</th>
              <th>Classe</th>
              <th>Niveau</th>
              <th>Effectif</th>
              <th>Chef</th>
              <th>Code Invit√©</th>
              <th>Modifier</th>
              <th>Apprenants</th>
              <th>Documents</th>
              <th>Supprimer</th>
              <th>Partenariat</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            {% for clas in MesClas %}
              <tr class="table-row">
                <td>{{ clas.id }}</td>
                <td><b>{{ clas.NomClasse }}</b></td>
                <td>{{ clas.Niveau }}</td>
                <td>{{ clas.Effectif }}</td>
                <td>{{ clas.ChefClasse }}</td>
                <td>{{ clas.CodeAffect }}</td>

                <td>
                  <center>
                  <a href="{% url 'ModifClasses' clas.id %}" class="zoom-link">
                    <i class="bi bi-pen-fill"></i>
                  </a></center>
                </td>

                <td>
                  <center>
                  <a href="{% url 'AjouterApprClasses' clas.id %}" class="zoom-link">
                    <i class="bi bi-person-add"></i>
                  </a></center>
                </td>

                <td>
                  <center>
                    <a href="{% url 'Ajouter_document' clas.id %}" class="zoom-link">
                      <i class="bi bi-folder-plus"></i>
                    </a>
                  </center>
                </td>

                <td>
                  <center>
                  <a href="{% url 'SuppClasses' clas.id %}"
                     onclick="return confirm('Voulez-vous vraiment supprimer cette classe ?')"
                     class="zoom-link"><i class="bi bi-trash3-fill"></i>
                    <!--img width="30" src="{% static 'images/Logo/corbeille.png' %}" alt="Supprimer"-->
                  </a></center>
                </td>

                <td>
                  <a href="{% url 'CreerPartenariatClasses' clas.id %}" class="zoom-link">
                    <img width="40" class="rounded"
                         src="https://www.egfbtp.com/wp-content/uploads/2021/06/partenariat.jpg"
                         alt="Partenariat">
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>

        <!-- Pagination -->
        <div id="pagination" class="text-center mt-4"></div>

      {% else %}
        <div class="alert alert-warning text-center">
          <i class="bi bi-exclamation-triangle"></i> Aucune classe trouv√©e pour le moment.
        </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Styles -->
<style>
  .table-row:hover {
    background-color: #f1f9f1;
    transition: background-color 0.3s ease-in-out;
  }

  .zoom-link img {
    transition: transform 0.3s ease-in-out;
  }

  .zoom-link img:hover {
    transform: scale(1.15);
  }

  .action-btn {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .action-btn:hover {
    transform: scale(1.05);
    box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.2);
  }

  #searchInput {
    border-radius: 50px;
    padding: 10px 20px;
    font-size: 16px;
  }

  #searchInput:focus {
    border-color: #198754;
    box-shadow: 0 0 8px rgba(25, 135, 84, 0.5);
  }

  .rounded-4 {
    border-radius: 1.2rem !important;
  }

  /* Pagination styling */
  .pagination-btn {
    margin: 3px;
    border: none;
    padding: 6px 12px;
    background: #198754;
    color: #fff;
    border-radius: 4px;
    cursor: pointer;
    transition: 0.3s;
  }

  .pagination-btn:hover {
    background: #146c43;
  }

  .pagination-btn.active {
    background: #0d5031;
    font-weight: bold;
  }
</style>

<!-- Script de recherche + pagination -->
<script>
  const rowsPerPage = 10;
  const rows = document.querySelectorAll("#tableBody tr");
  const pagination = document.getElementById("pagination");
  const searchInput = document.getElementById("searchInput");

  let currentPage = 1;
  let filteredRows = [...rows];

  function displayTableRows(page) {
    const start = (page - 1) * rowsPerPage;
    const end = start + rowsPerPage;
    rows.forEach(r => r.style.display = "none");
    filteredRows.slice(start, end).forEach(r => r.style.display = "");
  }

  function setupPagination() {
    pagination.innerHTML = "";
    const pageCount = Math.ceil(filteredRows.length / rowsPerPage);
    for (let i = 1; i <= pageCount; i++) {
      const btn = document.createElement("button");
      btn.innerText = i;
      btn.className = "pagination-btn";
      if (i === currentPage) btn.classList.add("active");
      btn.addEventListener("click", () => {
        currentPage = i;
        displayTableRows(currentPage);
        setupPagination();
      });
      pagination.appendChild(btn);
    }
  }

  function filterTable() {
    const filter = searchInput.value.toLowerCase();
    filteredRows = [...rows].filter(row =>
      row.textContent.toLowerCase().includes(filter)
    );
    currentPage = 1;
    displayTableRows(currentPage);
    setupPagination();
  }

  searchInput.addEventListener("keyup", filterTable);

  // Initialisation
  displayTableRows(currentPage);
  setupPagination();
</script>

<!-- Ic√¥nes Bootstrap -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">





{% endblock content %}