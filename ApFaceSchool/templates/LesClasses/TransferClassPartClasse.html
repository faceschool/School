{% extends "Menus/MenuEspaceForm.html" %}
{% block content %}
{% load static %}

<div class="container-fluid">
  <div class="text-center my-4">
    <h4 class="fw-bold text-primary">
      <img
        width="4%"
        src="https://cdn-icons-png.flaticon.com/512/179/179616.png"
        class="img-fluid me-2"
        alt="FaceSchool"
      />
      TRANSFERT DE CLASSE À CLASSE
    </h4>
    <hr class="w-25 mx-auto" />
  </div>

  <div class="row m-3">
    <!-- Liste des Apprenants transférés -->
    <div class="col-md-5 mb-4 shadow rounded bg-white p-3">
      <div class="card-header bg-primary text-white text-center fw-bold rounded">
        <i class="bi bi-people-fill me-2"></i>Liste des Apprenants Transférés
      </div>
      <div class="table-responsive mt-3">
        <table class="table table-striped table-bordered align-middle">
          <thead class="table-success text-center">
            <tr>
              <th>Matricule</th>
              <th>Nom</th>
              <th>Prénom</th>
              <th>Niveau</th>
            </tr>
          </thead>
          <tbody>
            {% for ap in Appren %}
            <tr>
              <td>{{ ap.apprenant_id }}</td>
              <td>{{ ap.apprenant.Nom }}</td>
              <td>{{ ap.apprenant.Prenom }}</td>
              <td>{{ ap.apprenant.Niveau }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="4" class="text-center text-muted">
                Aucun apprenant transféré.
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      <div class="text-center mt-2 fw-bold">
        Total : <span class="text-primary">{{ Total }}</span>
      </div>
    </div>

    <!-- Formulaire de transfert -->
    {% if not DocClass %}
    <div class="col-md-5 mb-4 shadow rounded bg-white p-3">
      <div class="card-header bg-primary text-white text-center fw-bold rounded">
        <i class="bi bi-arrow-left-right me-2"></i>Transfert vers une autre
        classe
      </div>

      <div class="mt-3">
        {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} shadow-sm py-2">
          {{ message }}
        </div>
        {% endfor %}
        {% endif %}
      </div>

      <form method="post" class="p-2">
        {% csrf_token %}
        {% if form.non_field_errors %}
        <div class="alert alert-danger">
          {% for error in form.non_field_errors %}
          <div>{{ error }}</div>
          {% endfor %}
        </div>
        {% endif %}

        <div class="mb-3">
          <label for="classe" class="form-label fw-bold">Classe :</label>
          <select
            class="form-select"
            name="IDClasse"
            id="classe"
            required
          >
            <option value="">— Sélectionnez une classe —</option>
            {% for Class in MesClasses %}
            <option value="{{ Class.id }}">{{ Class.NomClasse }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="mb-3">
          <label class="form-label fw-bold">Niveau :</label>
          <p class="form-control-plaintext">{{ MClasse.Niveau }}</p>
        </div>

        <div class="mb-3">
          <label for="codeAffect" class="form-label fw-bold"
            >Code Classe Demandeur :</label
          >
          <input
            type="text"
            name="CodeAffect"
            class="form-control"
            id="codeAffect"
            placeholder="Entrez le code partenaire"
            required
          />
        </div>

        <div class="text-center mt-4">
          <button type="submit" class="btn btn-success">
            <i class="bi bi-send-check me-1"></i> Transférer
          </button>
        </div>
      </form>
    </div>
    {% endif %}
  </div>
</div>


{% endblock content %}