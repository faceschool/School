{% extends base_template %}
{% block content %}
{% load static %}

<style>
/* --- Style global --- */
body {
  background-color: #f8fafc;
}

/* --- Cartes et tableaux --- */
.table-responsive {
  border-radius: 10px;
  background: #fff;
  padding: 20px;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
}
.table-responsive:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.12);
}

/* --- Titres principaux --- */
.titre-principal {
  color: #0d6efd;
  font-weight: bold;
  font-size: 1.5rem;
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* --- Tableaux --- */
.table {
  border-radius: 10px;
  overflow: hidden;
  text-align: center;
}
.table thead {
  background: linear-gradient(90deg, #0d6efd, #20c997);
  color: white;
}
.table tbody tr {
  transition: all 0.3s ease;
}
.table tbody tr:hover {
  background-color: rgba(13,110,253,0.08);
  transform: scale(1.005);
}

/* --- Boutons --- */
.btn {
  transition: all 0.3s ease;
  font-weight: 600;
}
.btn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 10px rgba(13,110,253,0.3);
}

/* --- Champs de formulaire --- */
select:focus {
  border-color: #0d6efd;
  box-shadow: 0 0 10px rgba(13,110,253,0.3);
}

/* --- Notification message --- */
.alert {
  animation: fadeInDown 0.6s ease;
  border-radius: 8px;
}
@keyframes fadeInDown {
  from { opacity: 0; transform: translateY(-15px); }
  to { opacity: 1; transform: translateY(0); }
}

/* --- Image titre --- */
.img-fluid {
  border-radius: 8px;
  transition: transform 0.3s ease;
}
.img-fluid:hover {
  transform: scale(1.05);
}
</style>

<div class="container-fluid">

  <!-- ✅ Titre principal -->
  <hr>
  <div class="m-3 text-center">
    <img width="5%" src="https://www.egfbtp.com/wp-content/uploads/2021/06/partenariat.jpg"
         class="img-fluid mb-2" alt="Partenariat"/>
    <b class="titre-principal">Mes Classes Partenaires</b>
  </div>
  <hr>

  <div class="row m-3">

    <!-- ✅ Liste des partenariats -->
    <div class="col-md-6 col-lg-6 table-responsive mb-3">
      <div class="mb-2">
        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }} shadow-sm text-center">{{ message }}</div>
          {% endfor %}
        {% endif %}
      </div>

      <p><b>CLASSE :</b> <span class="text-primary">{{ pk }} - {{ MesClasse }}</span></p>

      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th>Classes Partenaires</th>
            <th>Établissement</th>
            <th>Responsable</th>
            <th>Documents</th>
          </tr>
        </thead>
        <tbody class="table-group-divider">
          {% for Listes in ListePartenariats %}
            {% if Listes.ClassPartenaire_id == pk %}
              <tr>
                <td><b class="text-danger">{{ Listes.ClassDemandeur.NomClasse }} - {{ Listes.ClassDemandeur.id }}</b></td>
                <td>{{ Listes.ClassDemandeur.CodeEts }}</td>
                <td>{{ Listes.ClassDemandeur.ChefClasse }}</td>
                <td>
                  <a href="{% url 'ListeDocumentPartMaClasse' Listes.ClassDemandeur_id %}">
                    <img width="40" src="https://static.vecteezy.com/ti/vecteur-libre/t1/8292836-dossier-avec-documents-emploi-entreprise-et-finance-embauche-dossier-de-documents-avec-feuilles-de-papier-et-notes-adhesives-illustration-de-dessin-anime-isoler-sur-fond-blanc-vectoriel.jpg"
                         class="img-fluid" alt="Documents"/>
                  </a>
                </td>
              </tr>
            {% endif %}
            {% if Listes.ClassDemandeur_id == pk %}
              <tr>
                <td><b class="text-danger">{{ Listes.ClassPartenaire.NomClasse }} - {{ Listes.ClassPartenaire.id }}</b></td>
                <td>{{ Listes.ClassPartenaire.CodeEts }}</td>
                <td>{{ Listes.ClassPartenaire.ChefClasse }}</td>
                <td>
                  <a href="{% url 'ListeDocumentPartMaClasse' Listes.ClassPartenaire_id %}">
                    <img width="40" src="https://static.vecteezy.com/ti/vecteur-libre/t1/8292836-dossier-avec-documents-emploi-entreprise-et-finance-embauche-dossier-de-documents-avec-feuilles-de-papier-et-notes-adhesives-illustration-de-dessin-anime-isoler-sur-fond-blanc-vectoriel.jpg"
                         class="img-fluid" alt="Documents"/>
                  </a>
                </td>
              </tr>
            {% endif %}
          {% empty %}
            <tr><td colspan="4" class="text-center text-danger">Aucun partenariat trouvé.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- ✅ Documents par classe -->
    <div class="col-md-5 col-lg-5 table-responsive">
      <center>
        <label class="form-label">CLASSE :</label>
        ====<b>[{{ pk }} - {{ MesClasse }}]</b>====
      </center>
      <hr>
      <div class="text-center mb-3">Vous pouvez trier par type de document :</div>

      <form method="POST" enctype="multipart/form-data"
            action="{% url 'ListeDocumentPartClasseFil' pk %}"
            class="p-4 shadow-sm rounded bg-light">
        {% csrf_token %}
        <div class="text-center">
          <b><label for="Type" class="form-label">Type de document :</label></b>
          <select class="form-select d-inline-block w-auto" name="Type" id="Type">
            {% for type in MesTypes %}
              <option value="{{ type.TypeDoc }}">{{ type.TypeDoc }}</option>
            {% endfor %}
          </select>
          <button type="submit" class="btn btn-primary ms-2">OK</button>
        </div>
      </form>

      {% if type_doc %}
        <div class="text-center mt-2">Trié par : <b>[{{ type_doc }}]</b></div>
      {% endif %}

      <table class="table table-striped table-bordered mt-3">
        <thead>
          <tr>
            <th>Discipline</th>
            <th>Titre</th>
            <th>Type</th>
            <th>Document</th>
          </tr>
        </thead>
        <tbody>
          {% for doc in DocClass %}
            <tr>
              <td>{{ doc.Discipline }}</td>
              <td>{{ doc.Titre }}</td>
              <td>{{ doc.TypeDoc }} - {{ doc.id }}</td>
              <td>
                <a href="{{ doc.Document.url }}" download class="btn btn-sm btn-outline-success">
                  Télécharger
                </a>
              </td>
            </tr>
          {% empty %}
            <tr><td colspan="4" class="text-center text-danger">Aucun document.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</div>


{% endblock content %}