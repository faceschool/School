{% extends "Menus/Menu.html" %}
{% block content %}
{% if validlink %}
{% load widget_tweaks %}

<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-lg-6 col-md-8 col-sm-10">
      {% if validlink %}
        <div class="card shadow-lg border-0 rounded-4">
          <div class="card-body p-4">
            <h3 class="text-center text-primary mb-3">ğŸ”‘ RÃ©initialisation du mot de passe</h3>
            <p class="text-muted text-center">Veuillez saisir votre nouveau mot de passe ci-dessous.</p>

            <form method="post">
              {% csrf_token %}

              <!-- Champ : Nouveau mot de passe -->
              <div class="mb-3">
                <label for="{{ form.new_password1.id_for_label }}" class="form-label fw-semibold">
                  Nouveau mot de passe
                </label>
                {{ form.new_password1|add_class:"form-control" }}
                {% for error in form.new_password1.errors %}
                  <div class="text-danger small mt-1">{{ error }}</div>
                {% endfor %}
              </div>

              <!-- Champ : Confirmation -->
              <div class="mb-3">
                <label for="{{ form.new_password2.id_for_label }}" class="form-label fw-semibold">
                  Confirmer le nouveau mot de passe
                </label>
                {{ form.new_password2|add_class:"form-control" }}
                {% for error in form.new_password2.errors %}
                  <div class="text-danger small mt-1">{{ error }}</div>
                {% endfor %}
              </div>

              <div class="d-grid mt-4">
                <button type="submit" class="btn btn-primary">
                  ğŸ”„ Changer mon mot de passe
                </button>
              </div>
            </form>
          </div>
        </div>
      {% else %}
        <!-- Cas : lien invalide -->
        <div class="card shadow-lg border-0 rounded-4 text-center">
          <div class="card-body p-5">
            <i class="bi bi-exclamation-triangle-fill text-warning" style="font-size: 3rem;"></i>
            <h3 class="text-danger mt-3">Ã‰chec de la rÃ©initialisation</h3>
            <p class="text-muted">
              Le lien de rÃ©initialisation est invalide ou a expirÃ©.<br>
              Veuillez recommencer la procÃ©dure.
            </p>
            <a href="{% url 'password_reset' %}" class="btn btn-outline-primary mt-3">
              ğŸ” Demander un nouveau lien
            </a>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}